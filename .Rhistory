gather(-fecha, value = Rendimiento, key=Activo_comm)
dta_fram_commodities_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm))+
geom_line()+
scale_y_log10()
dta_fram_commodities_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm))+
geom_line()+
facet_wrap(.~Activo_comm, scales = "free")
Alternatives_Portfolio %>%
ggplot(aes(KC.F.Adjusted))+
geom_density()
Fibras <- c("FMTY14.MX", "FUNO11.MX", "FIBRAPL14.MX", "FIBRAMQ12.MX")
getSymbols(Fibras)
Fibras_ad <- NULL
for(i in Fibras){
assign(paste0("Ad_",i), Ad(get(i)))
Commodities_ad <- c(Commodities_ad, paste0("Ad_",i))
}
Commodities_Portfolio <- merge.xts(get(Commodities_ad[1]),
get(Commodities_ad[2]),
join = "inner")
for(i in 3:length(Commodities_ad)){
Commodities_Portfolio <- merge.xts(Commodities_Portfolio,
get(Commodities_ad[i]),
join = "inner")
}
Commodities_Returns <- Return.calculate(Commodities_Portfolio)[-1,]
Fibras <- c("FMTY14.MX", "FUNO11.MX", "FIBRAPL14.MX", "FIBRAMQ12.MX")
getSymbols(Fibras)
Fibras_ad <- NULL
for(i in Fibras){
assign(paste0("Ad_",i), Ad(get(i)))
Fibras_ad <- c(Fibras_ad, paste0("Ad_",i))
}
Fibras_Portfolio <- merge.xts(get(Fibras_ad[1]),
get(Fibras_ad[2]),
join = "inner")
for(i in 3:length(Fibras_ad)){
Fibras_Portfolio <- merge.xts(Fibras_Portfolio,
get(Fibras_Portfolio[i]),
join = "inner")
}
Fibras <- c("FMTY14.MX", "FUNO11.MX", "FIBRAPL14.MX", "FIBRAMQ12.MX")
getSymbols(Fibras)
Fibras_ad <- NULL
for(i in Fibras){
assign(paste0("Ad_",i), Ad(get(i)))
Fibras_ad <- c(Fibras_ad, paste0("Ad_",i))
}
Fibras_Portfolio <- merge.xts(get(Fibras_ad[1]),
get(Fibras_ad[2]),
join = "inner")
for(i in 3:length(Fibras_ad)){
Fibras_Portfolio <- merge.xts(Fibras_Portfolio,
get(Fibras_ad[i]),
join = "inner")
}
Fibras_Returns <- Return.calculate(Fibras_Portfolio)[-1,]
Commodities <- c("KC=F", "SB=F", "GC=F", "SI=F", "ZW=F", "ZC=F")
getSymbols(Commodities, from=as.Date("2017-02-05"), to=Sys.Date())
library(tidyverse)
library(quantmod)
library(PortfolioAnalytics)
library(fPortfolio)
library(PerformanceAnalytics)
library(readr)
library(psych)
library(DEoptim)
library(visdat)
library(ghyp)
library(tidyverse)
library(psych)
library(visdat)
library(readr)
library(readxl)
library(quantmod)
Equity <- c("AMZN", "WM", "NVS", "SAN", "BIMBOA.MX", "C", "NVDA")
getSymbols(Equity, from=as.Date("2017-02-05"), to=Sys.Date())
Equity_ad <- NULL
for(i in Equity){
assign(paste0("Ad_",i), Ad(get(i)))
Equity_ad <- c(Equity_ad, paste0("Ad_",i))
}
Equity_Portfolio <- merge.xts(get(Equity_ad[1]),
get(Equity_ad[2]),
join = "inner")
for(i in 3:length(Equity_ad)){
Equity_Portfolio <- merge.xts(Equity_Portfolio,
get(Equity_ad[i]),
join = "inner")
}
Equity_Returns <- Return.calculate(Equity_Portfolio)[-1,]
Equity <- c("AMZN", "WM", "NVS", "SAN", "BIMBOA.MX", "C", "NVDA")
getSymbols(Equity, from=as.Date("2017-02-05"), to=Sys.Date())
Equity_ad <- NULL
for(i in Equity){
assign(paste0("Ad_",i), Ad(get(i)))
Equity_ad <- c(Equity_ad, paste0("Ad_",i))
}
Equity_Portfolio <- merge.xts(get(Equity_ad[1]),
get(Equity_ad[2]),
join = "inner")
for(i in 3:length(Equity_ad)){
Equity_Portfolio <- merge.xts(Equity_Portfolio,
get(Equity_ad[i]),
join = "inner")
}
Equity_Returns <- Return.calculate(Equity_Portfolio)[-1,]
Eq_Specs_Port <- portfolio.spec(c("AMZN", "WM", "NVS", "SAN", "BIMBOA.MX", "C", "NVDA"))
##### Add Constraints #####
Eq_Specs_Port <- add.constraint(Eq_Specs_Port,
type="full_investment")
Eq_Specs_Port <- add.constraint(Eq_Specs_Port,
type="long_only")
##### Add Objective #####
Eq_Specs_Port <- add.objective(Eq_Specs_Port,
type="risk",
name="StdDev")
Eq_Specs_Port <- add.objective(Eq_Specs_Port,
type='return',
name='mean')
Eq_Specs_Port
covnig <- function(R,portfolio){
a<-fit.NIGmv(R, silent=TRUE)
COV<-a@variance
mu<-a@expected.value
mu<-matrix(mu, ncol=1)
resultado<-list(mu=mu,
sigma=COV)
return(resultado)
}
Optimized_Port_NIG <- optimize.portfolio(Equity_Returns,
Eq_Specs_Port,
momentFUN = covnig,
optimize_method = "random",
trace = TRUE)
chart.Weights(Optimized_Port_NIG, plot.type = "barplot")
W_R_NIG <- extractWeights(Optimized_Port_NIG)
W_R_NIG
sum(W_R_NIG)
Return_Port_NIG <- Return.portfolio(Equity_Returns, W_R_NIG)
plot(cumsum(Return_Port_NIG))
plot(Return_Port_NIG)
plot(cumsum(Return_Port_NIG))
library(knitr)
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE))
?kable
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "latex")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "latex")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "html")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "latex")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "html")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "html")
kable(table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE), format = "html")
chart.RiskReward(Optimized_Port_NIG,
risk.col = 'StdDev',
return.col = 'mean',
chart.assets = TRUE)
Commodities <- c("KC=F", "SB=F", "GC=F", "SI=F", "ZW=F", "ZC=F")
getSymbols(Commodities, from=as.Date("2017-02-05"), to=Sys.Date())
Commodities_ad <- NULL
for(i in Commodities){
assign(paste0("Ad_",i), Ad(get(i)))
Commodities_ad <- c(Commodities_ad, paste0("Ad_",i))
}
Commodities_Portfolio <- merge.xts(get(Commodities_ad[1]),
get(Commodities_ad[2]),
join = "inner")
for(i in 3:length(Commodities_ad)){
Commodities_Portfolio <- merge.xts(Commodities_Portfolio,
get(Commodities_ad[i]),
join = "inner")
}
Commodities_Returns <- Return.calculate(Commodities_Portfolio)[-1,]
str(Commodities_Portfolio)
Commodities_Portfolio
class(Commodities_Portfolio)
# Commodities_Portafolio es una matriz xts. Para graficar sus variables hay que pasarlo a DataFrame
dta_fram_commodities <- as.data.frame(Commodities_Portfolio)
View(dta_fram_commodities)
#Debemos indexar
dta_fram_commodities <- dta_fram_commodities %>%
mutate(fecha=index(Commodities_Portfolio))
View(dta_fram_commodities)
dta_fram_commodities_tidy <- dta_fram_commodities %>%
gather(-fecha, value = Rendimiento, key=Activo_comm)
class(dta_fram_commodities_tidy)
View(dta_fram_commodities_tidy)
str(dta_fram_commodities_tidy)
?gather
# Ahora se crea una nueva DataFrame
dta_fram_commodities_tidy <- dta_fram_commodities %>%
gather(-fecha, value=Rendimiento,
key=Activo_comm)
dta_fram_commodities_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm))+
geom_line()+
scale_y_log10()
dta_fram_commodities_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm))+
geom_line()+
facet_wrap(.~Activo_comm, scales = "free")
view(Commodities_Portfolio)
View(Commodities_Returns)
class(Commodities_Returns)
# Commodities_Returns es una matriz xts. Para graficar sus variables hay que pasarlo a DataFrame
dta_fram_commod_return <- as.data.frame(Commodities_Returns)
#Debemos crear una nueva columna que sirva de guia con las fechas. La columna "fecha" es igual al index del objeto
dta_fram_commod_return <- dta_fram_commod_return %>%
mutate(fecha=index(Commodities_Returns))
View(dta_fram_commod_return)
# Ahora se crea una nueva DataFrame con tres columnas
dta_fram_commod_return_tidy <- dta_fram_commod_return %>%
gather(-fecha, value=Rendimiento,
key=Activo_comm_ret)
View(dta_fram_commod_return_tidy)
dta_fram_commod_return_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm))+
geom_line()+
facet_wrap(.~Activo_comm, scales = "free")
dta_fram_commod_return_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm_ret))+
geom_line()+
facet_wrap(.~Activo_comm, scales = "free")
dta_fram_commod_return_tidy %>%
ggplot(aes(x=fecha, y=Rendimiento, col=Activo_comm_ret))+
geom_line()+
facet_wrap(.~Activo_comm_ret, scales = "free")
View(dta_fram_commod_return_tidy)
dta_fram_commod_return_tidy %>%
ggplot(aes(x=fecha, y=cumsum(Rendimiento), col=Activo_comm_ret))+
geom_line()+
facet_wrap(.~Activo_comm_ret, scales = "free")
View(dta_fram_commod_return_tidy)
View(dta_fram_commod_return)
View(Equity_Returns)
View(Commodities_Returns)
Equity_Commodities_Returns_Port <- merge(Equity_Returns,Commodities_Returns,
by="ID")
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- merge(Equity_Returns,Commodities_Returns,
by=index("fecha"))
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- View(Equity_Commodities_Returns_Port) %>%
na.omit()
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- merge(Equity_Returns,Commodities_Returns,
by=index("fecha"))
Equity_Commodities_Returns_Port <- View(Equity_Commodities_Returns_Port) %>%
vis_miss()
class(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
vis_miss(Equity_Commodities_Returns_Port)
is.na(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- as.data.frame(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
vis_miss(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- Equity_Commodities_Returns_Port %>%
na.omit()
vis_miss(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,8]),
by.column = F)
chartSeries(Gold_correlation)
chartSeries(Coffe_correlation)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,8]),
by.column = F)
chartSeries(Coffe_correlation)
Equity_Commodities_Returns_Port <- as.xts(Equity_Commodities_Returns_Port)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,8]),
by.column = F)
chartSeries(Coffe_correlation)
#Average correlation
mean(na.omit(Coffe_correlation))
chartSeries(Coffe_correlation)
View(Equity_Returns)
View(Return_Port_NIG)
Equity_Commodities_Returns_Port <- merge(Equity_Returns,Commodities_Returns,Return_Port_NIG,
by=index("fecha"))
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- merge(Return_Port_NIG,Equity_Returns,Commodities_Returns,
by=index("fecha"))
View(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- as.data.frame(Equity_Commodities_Returns_Port)
vis_miss(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- Equity_Commodities_Returns_Port %>%
na.omit()
Equity_Commodities_Returns_Port <- as.xts(Equity_Commodities_Returns_Port)
View(Equity_Commodities_Returns_Port)
class(Equity_Commodities_Returns_Port)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,9]),
by.column = F)
chartSeries(Coffe_correlation)
Equity_Commodities_Returns_Port <- merge(Return_Port_NIG,Equity_Returns,Commodities_Returns,
by=index("fecha"))
Equity_Commodities_Returns_Port <- as.data.frame(Equity_Commodities_Returns_Port)
Equity_Commodities_Returns_Port <- Equity_Commodities_Returns_Port %>%
na.omit()
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,9]),
by.column = F)
class(Coffe_correlation)
View(Coffe_correlation)
cor_dta_fram_comm <- Equity_Commodities_Returns_Port %>%
mutate(cor_coffe=as.data.frame(Coffe_correlation))
cor_dta_fram_comm <- as.data.frame(Coffe_correlation)
View(cor_dta_fram_comm)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,9]),
by.column = F)
Sugar_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
with=253,
function(x) cor(x[,1], x[,10]))
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,9]),
by.column = F)
Sugar_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
with=253,
function(x) cor(x[,1], x[,10]),
by.column = F)
Sugar_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,10]),
by.column = F)
Coffe_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,9]),
by.column = F)
Sugar_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,10]),
by.column = F)
Gold_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,11]),
by.column = F)
Silver_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,12]),
by.column = F)
Wheat_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,13]),
by.column = F)
Corn_correlation <- rollapply(data=Equity_Commodities_Returns_Port,
width=253,
function(x) cor(x[,1], x[,14]),
by.column = F)
cor_dta_fram_comm <- as.data.frame(Coffe_correlation, Sugar_correlation)
View(cor_dta_fram_comm)
cor_dta_fram_comm <- as.data.frame(Coffe_correlation)
View(cor_dta_fram_comm)
cor_dta_fram_comm <- mutate(Sugar_correlation=as.data.frame(Sugar_correlation))
cor_dta_fram_comm <- Sugar_correlation %>%
mutate(Sugar_correlation=as.data.frame(Sugar_correlation))
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(Sugar_correlation=as.data.frame(Sugar_correlation))
View(cor_dta_fram_comm)
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(as.data.frame(Sugar_correlation))
View(cor_dta_fram_comm)
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(as.data.frame(Sugar_correlation),
as.data.frame(Gold_correlation),
as.data.frame(Silver_correlation),
as.data.frame(Wheat_correlation),
as.data.frame(Corn_correlation))
View(cor_dta_fram_comm)
summary(cor_dta_fram_comm)
class(fecha=index(Commodities_Portfolio))
class(cor_dta_fram_comm)
length(cor_dta_fram_comm
length(cor_dta_fram_comm)
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(as.data.frame(Sugar_correlation),
as.data.frame(Gold_correlation),
as.data.frame(Silver_correlation),
as.data.frame(Wheat_correlation),
as.data.frame(Corn_correlation),
fecha=index(Commodities_Portfolio[1:1020,]))
View(cor_dta_fram_comm)
View(Commodities_Portfolio)
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(as.data.frame(Sugar_correlation),
as.data.frame(Gold_correlation),
as.data.frame(Silver_correlation),
as.data.frame(Wheat_correlation),
as.data.frame(Corn_correlation),
fecha=index(Commodities_Portfolio[297:1317,]))
cor_dta_fram_comm <- cor_dta_fram_comm %>%
mutate(as.data.frame(Sugar_correlation),
as.data.frame(Gold_correlation),
as.data.frame(Silver_correlation),
as.data.frame(Wheat_correlation),
as.data.frame(Corn_correlation),
fecha=index(Commodities_Portfolio[298:1317,]))
view(cor_dta_fram_comm)
View(dta_fram_commod_return_tidy)
View(dta_fram_commod_return)
# Ahora se crea una nueva DataFrame con tres columnas
cor_dta_fram_comm_tidy <- cor_dta_fram_comm %>%
gather(-fecha, value=Rendimiento,
key=Activo_comm)
View(cor_dta_fram_comm_tidy)
# Ahora se crea una nueva DataFrame con tres columnas
cor_dta_fram_comm_tidy <- cor_dta_fram_comm %>%
gather(-fecha, value=Correlation,
key=Activo_comm)
View(cor_dta_fram_comm_tidy)
cor_dta_fram_comm_tidy %>%
ggplot(aes(x=fecha, y=Correlation, col=Activo_comm))+
geom_line()+
facet_wrap(.~Activo_comm, scales = "free")
View(Optimized_Port_NIG)
EqComKC.F_Specs_Port <- portfolio.spec(c("AMZN", "WM", "NVS", "SAN", "BIMBOA.MX", "C", "NVDA", "KC=F"))
##### Add Constraints #####
EqComKC.F_Specs_Port <- add.constraint(EqComKC.F_Specs_Port,
type="full_investment")
EqComKC.F_Specs_Port <- add.constraint(EqComKC.F_Specs_Port,
type="long_only")
##### Add Objective #####
EqComKC.F_Specs_Port <- add.objective(EqComKC.F_Specs_Port,
type="risk",
name="StdDev")
EqComKC.F_Specs_Port <- add.objective(EqComKC.F_Specs_Port,
type='return',
name='mean')
EqComKC.F_Specs_Port
kable(EqComKC.F_Specs_Port, format = "html")
EqComKC.F_Specs_Port
View(Equity_Returns)
EquityKC.F_Returns <- Equity_Returns %>%
mutate(Coffe_returns="KC=F")
EquityKC.F_Returns <- Equity_Returns %>%
mutate(Coffe_returns=Commodities_Returns[[1]])
class(Eq_Specs_Port)
class(Equity_Returns)
EquityKC.F_Returns <- Equity_Returns
EquityKC.F_Returns <- Commodities_Returns %>%
mutate(Coffe_return="KC=F")
dta_frm_Commodities_Returns <- as.data.frame(Equity_Returns)
EquityKC.F_Returns <- Commodities_Returns %>%
mutate(Coffe_return="KC=F")
EquityKC.F_Returns <- dta_frm_Commodities_Returns %>%
mutate(Coffe_return="KC=F")
View(EquityKC.F_Returns)
dta_frm_Commodities_Returns <- as.data.frame(Commodities_Returns)
EquityKC.F_Returns <- dta_frm_Commodities_Returns %>%
mutate(Coffe_return=dta_frm_Commodities_Returns$KC.F.Adjusted)
View(EquityKC.F_Returns)
dta_frm_Equity_Returns <- as.data.frame(Equity_Returns)
EquityKC.F_Returns <- dta_frm_Equity_Returns %>%
mutate(Coffe_return=dta_frm_Commodities_Returns$KC.F.Adjusted)
EquityKC.F_Returns <- Equity_Returns
dta_frm_Commodities_Returns <- as.data.frame(Commodities_Returns)
dta_frm_Equity_Returns <- as.data.frame(Equity_Returns)
EquityKC.F_Returns <- dta_frm_Equity_Returns %>%
mutate(Coffe_return=dta_frm_Commodities_Returns$KC.F.Adjusted)
View(dta_frm_Commodities_Returns)
library(tidyverse)
library(quantmod)
library(PortfolioAnalytics)
library(fPortfolio)
library(PerformanceAnalytics)
library(readr)
library(psych)
library(DEoptim)
library(visdat)
library(ghyp)
library(tidyverse)
library(psych)
library(visdat)
library(readr)
library(readxl)
library(quantmod)
library(psych)
library(visdat)
library(readr)
library(readxl)
library(quantmod)
Equity <- c("AMZN", "WM", "NVS", "SAN", "BIMBOA.MX", "C", "NVDA")
getSymbols(Equity, from=as.Date("2017-02-05"), to=Sys.Date())
